グラフ類似性検索は、クエリ化合物と最も類似した化合物を見つけるなど、グラフベースの最も重要なアプリケーションの一つである。グラフ編集距離（GED）や最大公約数グラフ（MCS）などのグラフ類似性／距離計算は、グラフ類似性検索や他の多くのアプリケーションの中核をなす演算であるが、実際には非常に高い計算コストがかかる。我々は、ノードやグラフの分類などのグラフ応用において、近年ニューラルネットワークアプローチが成功を収めていることに触発され、この古典的かつ困難なグラフ問題に対して、良好な性能を維持しつつ計算負荷を軽減する、新しいニューラルネットワークベースアプローチを提案する。SimGNNと呼ばれるこの提案手法は、2つの戦略を組み合わせている。まず、全てのグラフを埋め込みベクトルに写像する学習可能な埋め込み関数を設計し、これによりグラフの全体的な要約を提供する。また、特定の類似度メトリックに関して重要なノードを強調するための新しいアテンション機構を提案する。第二に、グラフレベルの埋め込みをノードレベルの細かい情報で補完するために、ペアワイズノード比較法を設計する。我々のモデルは未知のグラフに対してより良い一般化を達成し、最悪の場合、2つのグラフのノード数に対して2次関数的な時間で実行される。GEDの計算を例にとり、3つの実グラフデータセットに対する実験結果から、我々のアプローチの有効性と効率性を実証する。具体的には、GED計算の近似アルゴリズムや既存のグラフニューラルネットワークベースのモデルなど、一連のベースラインと比較して、本モデルはより低いエラーレートと大きな時間短縮を達成することができた。本研究は、SimGNNがグラフ類似性計算とグラフ類似性検索に関する将来の研究に新たな方向性を与えることを示唆している1 .

# introduction

グラフは今やユビキタスな存在であり、バイオインフォマティクス、化学、リコメンダーシステム、ソーシャルネットワーク研究、プログラム静的解析など、幅広い応用が期待されている。これらのうち、基本的な問題の一つは、ユーザからの問い合わせがあった場合に、データベースから類似したグラフの集合を検索することである。グラフの類似度・距離の指標としては、Graph Edit Distance (GED) [4], Maximum Common Subgraph (MCS) [6] など、様々なものが定義されている。しかし、その中心となる2つのグラフ間のGEDやMCSの計算はNP完全であることが知られている[6, 55]。GEDについては、最新のアルゴリズムでさえ、16ノード以上のグラフ間の正確なGEDを合理的な時間内に確実に計算することはできない[1]。グラフ距離の厳密な計算が非常に重要でありながら非常に困難であることから、グラフ類似性探索の問題に対して、大きく2つのカテゴリーの手法が提案されている。第一のカテゴリーは、プルーニング-検証の枠組みであり[31, 55, 56]、この枠組みでは、一連のデータベース索引付け技術とプルーニング戦略により、クエリに対する厳密グラフ類似度計算の総量を扱いやすい程度に削減することが可能である。しかし、厳密なグラフ類似度計算の指数関数的な時間複雑性[33]という基本的な問題は残っています。第2のカテゴリーは、グラフ類似度計算のコストを直接削減しようとするものである。これらの手法は，厳密な類似度メトリックを計算する代わりに，高速かつ発見的な方法で近似値を求める[2, 8, 11, 33, 41]．しかし，これらの方法は通常，離散最適化や組合せ探索に基づく複雑な設計と実装を必要とする．また、A*-Beamsearch (Beam) [33], Hungarian [41], VJ [11] などは、通常、グラフのノード数に対して多項式あるいは準指数的な時間複雑性を有している。

本論文では、先に述べた2番目のカテゴリーの手法と同じ目的で、グラフの類似度計算を高速化する新しいアプローチを提案する。しかし、組み合わせ探索を用いて近似的な類似度を直接計算するのではなく、我々の解決策はそれを学習問題に転化させる。具体的には、グラフの組を類似度スコアにマッピングするニューラルネットワークベースの関数を設計する。学習段階では、この関数のパラメータは、予測された類似度スコアと真実の類似度スコアとの差を最小化することによって学習される。テスト段階では、学習した関数に任意のグラフのペアを与えることで、予測される類似度スコアを得ることができる。我々はこのようなアプローチをSimGNN（Similarity Computation via Graph Neural Networks）と名付ける。SimGNNは、ニューラルネットワーク計算の性質上、効率的であるという重要な利点を有している。しかし、効率性に関しては、以下の3つの性質を満たすように、ニューラルネットワークのアーキテクチャを慎重に設計する必要があります。

(1) 表現不変性。同じグラフでも、ノードの順序を並べ替えることで、異なる隣接行列で表現することができる。計算される類似度スコアはこのような変化に対して不変であるべきである。

(2)帰納的であること。類似度計算が未知のグラフに対して汎化されること，すなわち，学習グラフペア以外のグラフに対しても類似度スコアが計算されることが必要である．

(3) 学習可能であること。学習によりパラメータを調整することで、任意の類似度指標に適応できるモデルでなければならない。



これらの目標を達成するために、我々は以下の2つの戦略を提案する。まず、全てのグラフを埋め込みベクトルに写像する学習可能な埋め込み関数を設計し、ノードレベルの埋め込みを集約することでグラフの全体的な要約を提供する。また、特定の類似度メトリックに関して、グラフ全体から重要なノードを選択する新しいアテンション機構を提案する。このグラフレベルの埋め込みは、既にグラフ間の類似性をほぼ保持することができる。例えば、Fig.1に示すように、グラフAはグランドトゥルースの類似度によればグラフQと非常に類似しており、その埋め込みは埋め込み空間においてQに近いため、埋め込みに反映される。また、このような埋め込みに基づく類似度計算は非常に高速である。第二に、グラフレベルの埋め込みをきめ細かいノードレベルの情報で補完するために、ペアワイズノード比較法を設計する。1つのグラフに対して1つの固定長の埋め込みでは粗すぎる可能性があるため、さらに2つのグラフからノード間のペアワイズ類似度スコアを計算し、そこからヒストグラム特徴を抽出してグラフレベルの情報と組み合わせることで、モデルの性能を向上させることができます。この結果、グラフサイズに対して2次関数的な演算が必要となるが、それでもグラフ類似度計算の最も効率的な手法の一つである。

グラフの類似性・距離の指標として最もよく知られているGED計算を対象に実験を行う。本アプローチの有効性と効率性を実証するため、3つの実グラフデータセットで実験を行った。近似的なGED計算アルゴリズムやグラフニューラルネットワークを用いた手法などのベースラインと比較し、我々のモデルは誤差が少なく、大幅な時間短縮を達成することができる。また、本手法は既存の手法と比較して優れた性能を発揮していることも特筆される。また、計算時間を重視する場合は、より時間のかかるStrategy 2とトレードオフすることも可能である。

私たちの貢献は次のようにまとめられます。

- 我々は、グラフの類似性計算という古典的でありながら挑戦的な問題を、学習問題として捉え、その解決策としてSimGNNと呼ばれるニューラルネットワークに基づくアプローチを提案する。
- 2つの新しい戦略が提案される。まず、グラフ間の類似性を保持するグラフレベルの埋め込みを生成するために、グラフの最も関連性の高い部分を選択する効率的かつ効果的なアテンション機構を提案する。第二に、2つのグラフ間の類似性をより効果的にモデル化するために、グラフレベルの埋め込みを補完するペアワイズノード比較手法を提案する。
- - 提案手法の有効性と効率性を実証するために、3つの実ネットワークデータセットに基づき、非常に有名なグラフ類似性/距離メトリックであるGEDに関する広範な実験を行う。 

本論文の残りの部分は以下のように構成されている。セクション 2 で我々の研究の前置きを紹介し、セクション 3 で我々のモデルを説明し、セクション 4 で実験結果を示し、セクション 5 で関連する仕事を議論し、セクション 6 で将来の方向性を指摘する。結論はセクション 7 で述べる。

